name = "År",
breaks = unique(modstander_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = paste0("Tilskuertal gennem årene mod ", valgt_modstander, " - Total vs Gennemsnit"),
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
pacman::p_load("ggplot2", "readxl", "ggrepel")
options(scipen = 999)
pacman::p_load("tidyverse")
vffkort <- read_rds("c:/Users/PHSXX/OneDrive/Dania Erhversakademi/Datavisualisering/GitHub/Datavisualisering_gruppe3/vffkort01.rds")
str(vffkort)
vffkort_renset <- vffkort |>
mutate(
modstander = str_split_fixed(hold, "-", 2)[,2]
) |>
rename(aar = år)
str(vffkort_renset)
# Line plot med facetter - Udviklingen for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "fixed", ncol = 4) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"),
legend.position = "none"
)
simpel <- ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line()
simpel
simpel <- ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8)
simpel <- ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, colour = "darkblue")
simpel
# Line plot med facetter - Udviklingen for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "fixed", ncol = 4) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"),
legend.position = "none"
)
# Ridge plot - Hver modstander som separat "bølge" med min/max værdier på ridges
pacman::p_load("ggridges")
# Beregn min og max tilskuere for hver modstander + hvilket år det skete
modstander_stats <- vffkort_renset |>
group_by(modstander) |>
summarise(
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
aar_min = aar[which.min(tilskuere)][1],
aar_max = aar[which.max(tilskuere)][1],
.groups = "drop"
)
ggplot(vffkort_renset, aes(x = aar, y = modstander, height = tilskuere, fill = modstander)) +
geom_density_ridges(stat = "identity", alpha = 0.7, scale = 2.5) +
geom_text(data = modstander_stats, aes(x = aar_min, y = modstander, label = paste0("Min: ", min_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkblue") +
geom_text(data = modstander_stats, aes(x = aar_max, y = modstander, label = paste0("Max: ", max_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkred") +
labs(
x = "År",
y = "Modstander",
title = "Tilskuertal gennem årene - Ridge plot"
) +
theme_bw() +
theme(
legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Bar + line plot - Total vs Gennemsnit
vffkort_summary <- vffkort_renset |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere), fill = "lightblue", alpha = 0.7, width = 0.6) +
geom_text(aes(y = total_tilskuere, label = format(total_tilskuere, big.mark = ".", decimal.mark = ",")), vjust = -0.5, size = 3) +
geom_text(aes(y = total_tilskuere * 0.5, label = paste0("Min: ", min_tilskuere, " | Max: ", max_tilskuere)),
vjust = 0.5, size = 2.5, colour = "darkblue", fontface = "italic") +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
geom_point(aes(y = middeltal), colour = "darkred", size = 3) +
geom_text(aes(y = middeltal, label = format(round(middeltal), big.mark = "")),
colour = "darkred", vjust = -0.8, size = 3, fontface = "bold") +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = "Tilskuertal gennem årene - Total vs Gennemsnit",
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
# Bar + line plot på modstander niveau - Total vs Gennemsnit
# Vælg modstander her:
valgt_modstander <- "BIF"
modstander_summary <- vffkort_renset |>
filter(modstander == valgt_modstander) |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
ggplot(modstander_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere), fill = "lightblue", alpha = 0.7, width = 0.6) +
geom_text(aes(y = total_tilskuere, label = format(total_tilskuere, big.mark = ".", decimal.mark = ",")), vjust = -0.5, size = 3) +
geom_text(aes(y = total_tilskuere * 0.5, label = paste0("Min: ", min_tilskuere, " | Max: ", max_tilskuere)),
vjust = 0.5, size = 2.5, colour = "darkblue", fontface = "italic") +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
geom_point(aes(y = middeltal), colour = "darkred", size = 3) +
geom_text(aes(y = middeltal, label = format(round(middeltal), big.mark = "")),
colour = "darkred", vjust = -0.8, size = 3, fontface = "bold") +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = paste0("Tilskuertal gennem årene mod ", valgt_modstander, " - Total vs Gennemsnit"),
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
# simpel
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, colour = "darkblue") +
labs(
x = "År",
y = "Antal tilskuere",
titel = "Tilskuertal gennem årene"
)
# simpel
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, colour = "darkblue") +
labs(
x = "År",
y = "Antal tilskuere",
titel = "Tilskuertal gennem årene"
)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Gns. tilskuertal gennem årene"
)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Gns. tilskuertal gennem årene"
)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = total_tilskuere), colour = "darkred", linewidth = 1.2, group = 1)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_bar(aes(y = total_tilskuere), colour = "darkred", linewidth = 1.2, group = 1)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_bar(aes(y = total_tilskuere), colour = "darkred")
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = total_tilskuere), colour = "darkred", linewidth = 1.2, group = 1)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = max_tilskuere), colour = "darkred", linewidth = 1.2, group = 1)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = max_tilskuere), colour = "darkred", linewidth = 1.2, group = 1) +
geom_line(aes(y = min_tilskuere), colour = "darkblue", linewidth = 1.2, group = 1)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = max_tilskuere), colour = "darkred", linewidth = 1.2, group = 1) +
geom_line(aes(y = min_tilskuere), colour = "darkblue", linewidth = 1.2, group = 1) +
geom_point(aes(y = tilskuere))
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = max_tilskuere), colour = "darkred", linewidth = 1.2, group = 1) +
geom_line(aes(y = min_tilskuere), colour = "darkblue", linewidth = 1.2, group = 1) +
geom_point(aes(y = tilskuere)) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Gns. tilskuertal gennem årene"
)
str(vffkort_summary)
str(vffkort_renset)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = max_tilskuere), colour = "darkred", linewidth = 1.2, group = 1) +
geom_line(aes(y = min_tilskuere), colour = "darkblue", linewidth = 1.2, group = 1) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Gns. tilskuertal gennem årene"
)
ggplot(vffkort_renset, aes(x = aar, y = tilskuere))
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point()
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_point(aes(y = d3_tilskuere))
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_point(aes(y = d3_tilskuere, colour = "darkred"))
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_line(aes(y = d3_tilskuere, colour = "darkred"))
ggplot(vffkort_summary, aes(x = aar, y = antal_kampe)) +
geom_point()
ggplot(vffkort_summary, aes(x = aar)) +
geom_point(aes( y = antal_kampe))
ggplot(vffkort_summary, aes(x = aar)) +
geom_point(aes( y = antal_kampe)) +
geom_line(aes(y = total_tilskuere))
ggplot(vffkort_summary, aes(x = aar)) +
geom_point(aes( y = antal_kampe)) +
geom_line(aes(y = total_tilskuere)) +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_point(aes( y = antal_kampe)) +
geom_line(aes(y = total_tilskuere)) +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_point(aes( y = antal_kampe)) +
geom_line(aes(y = total_tilskuere)) +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_point(aes( y = antal_kampe)) +
geom_line(aes(y = total_tilskuere))
ggplot(vffkort_summary, aes(x = antal_kampe)) +
geom_line(aes(y = total_tilskuere))
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = total_tilskuere))
ggplot(vffkort_summary, aes(x = aar)) +
geom_bar(aes(y = total_tilskuere))
ggplot(vffkort_summary, aes(x = aar, y = total_tilskuere)) +
geom_bar()
ggplot(vffkort_summary, aes(x = aar, y = total_tilskuere)) +
geom_col()
ggplot(vffkort_summary, aes(x = aar, y = total_tilskuere)) +
geom_col() +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere)) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere)) +
geom_line(aes(y = middeltal))
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere)) +
geom_line(aes(y = middeltal))
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere)) +
geom_line(aes(y = middeltal)) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere)) +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere), alpha = 0.3) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere), alpha = 0.3) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
) +
scale_y_continuous(
name = "Max tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
)
pacman::p_load("ggplot2", "readxl", "ggrepel")
options(scipen = 999)
pacman::p_load("tidyverse")
vffkort <- read_rds("c:/Users/PHSXX/OneDrive/Dania Erhversakademi/Datavisualisering/GitHub/Datavisualisering_gruppe3/vffkort01.rds")
str(vffkort)
vffkort_renset <- vffkort |>
mutate(
modstander = str_split_fixed(hold, "-", 2)[,2]
) |>
rename(aar = år)
str(vffkort_renset)
vffkort_summary <- vffkort_renset |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
str(vffkort_summary)
# simpel
ggplot(vffkort_summary, aes(x = aar)) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2, group = 1) +
geom_line(aes(y = max_tilskuere), colour = "darkred", linewidth = 1.2, group = 1) +
geom_line(aes(y = min_tilskuere), colour = "darkblue", linewidth = 1.2, group = 1) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Gns. tilskuertal gennem årene"
)
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar)) +
geom_point(aes(y = modstander))
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar)) +
geom_line(aes(y = tilskuere)) +
geom_point(aes(y = modstander))
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar)) +
geom_line(aes(y = tilskuere))
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar)) +
geom_line(aes(y = tilskuere)) +
geom_smooth(method = "lm")
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_smooth(method = "lm")
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point(colour = "darkgreen") +
geom_smooth(method = "lm")
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_smooth(method = "lm")
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point(colour = "darkgreen") +
geom_smooth(method = "lm")
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_smooth(method = "lm", colour = "darkgreen")
# ------------------
# test:
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_point() +
geom_smooth(method = "lm", colour = "green")
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere), alpha = 0.3) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
) +
scale_y_continuous(
name = "Max tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere), alpha = 0.3) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Max tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
)
# max tilskuere pr år og det gns. tilskuere tal
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere), alpha = 0.3) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Max tilskuere",
sec.axis = sec_axis(~.*10, name = "Gennemsnitligt tilskuertal")
)
# max tilskuere pr år og det gns. tilskuere tal
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = max_tilskuere), alpha = 0.3) +
geom_line(aes(y = middeltal), colour = "darkgreen", linewidth = 1.2) +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Max tilskuere",
sec.axis = sec_axis(~., name = "Gennemsnitligt tilskuertal")
)
