geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "free_y", ncol = 4) +
labs(x = "År", y = "Tilskuertal", title = "Udvikling per modstander") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"))
bar_total <- ggplot(modstander_summary, aes(x = reorder(modstander, total), y = total, fill = modstander)) +
geom_col(alpha = 0.7) +
labs(x = "Modstander", y = "Total tilskuertal", title = "Samlet tilskuertal") +
theme_bw() +
theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust = 1))
line_facet / bar_total
# 5. Combo plot - Area + tekst labels for Top 3 modstandere
top3 <- modstander_summary |> arrange(desc(gennemsnit)) |> head(3) |> pull(modstander)
ggplot(vffkort_renset, aes(x = aar, y = tilskuere, fill = modstander)) +
geom_area(alpha = 0.6, colour = "white", linewidth = 0.3) +
geom_text(data = modstander_summary |> filter(modstander %in% top3),
aes(x = Inf, y = total * 0.5, label = paste0(modstander, "\nGennemsnit: ", format(round(gennemsnit), big.mark = "."))),
hjust = 1.1, vjust = 0.5, size = 3, inherit.aes = FALSE, fontface = "bold") +
labs(
x = "År",
y = "Tilskuertal",
title = "Udvikling med Top 3 modstandere markeret",
fill = "Modstander"
) +
scale_fill_brewer(palette = "Set3") +
theme_bw() +
theme(legend.position = "bottom",
plot.margin = margin(r = 150))
# 4. Facettet line plot + Bar chart under (stacked vertically)
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "free_y", ncol = 4) +
labs(x = "År", y = "Tilskuertal", title = "Udvikling per modstander") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"))
# Bar charts - Gennemsnit og Total tilskuertal per modstander
pacman::p_load("patchwork")
bar_gennemsnit <- ggplot(modstander_summary, aes(x = reorder(modstander, gennemsnit), y = gennemsnit, fill = modstander)) +
geom_col(alpha = 0.7) +
geom_text(aes(label = format(round(gennemsnit), big.mark = ".")), vjust = -0.5, size = 2.5) +
labs(
x = "Modstander",
y = "Gennemsnitligt tilskuertal",
title = "Gennemsnitligt tilskuertal"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none"
)
bar_total <- ggplot(modstander_summary, aes(x = reorder(modstander, total), y = total, fill = modstander)) +
geom_col(alpha = 0.7) +
geom_text(aes(label = format(total, big.mark = ".")), vjust = -0.5, size = 2.5) +
labs(
x = "Modstander",
y = "Total tilskuertal",
title = "Total tilskuertal"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none"
)
bar_gennemsnit + bar_total
# Bar chart - Gennemsnit og Total tilskuertal per modstander (sammen i samme graf)
modstander_summary_long <- modstander_summary |>
pivot_longer(cols = c(gennemsnit, total), names_to = "type", values_to = "værdi") |>
mutate(type = factor(type, levels = c("gennemsnit", "total")))
ggplot(modstander_summary_long, aes(x = reorder(modstander, værdi, FUN = max), y = værdi, fill = type)) +
geom_col(alpha = 0.7, position = "dodge") +
geom_text(aes(label = format(round(værdi), big.mark = ".")), vjust = -0.5, size = 2.5, position = position_dodge(width = 0.9)) +
labs(
x = "Modstander",
y = "Tilskuertal",
title = "Gennemsnitligt og Total tilskuertal per modstander",
fill = "Type"
) +
scale_fill_manual(values = c("gennemsnit" = "lightblue", "total" = "darkblue")) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
# Bar chart - Gennemsnit og Total tilskuertal per modstander (sammen i samme graf)
modstander_summary_long <- modstander_summary |>
pivot_longer(cols = c(gennemsnit, total), names_to = "type", values_to = "værdi") |>
mutate(type = factor(type, levels = c("gennemsnit", "total")))
# Sortér modstanderne efter gennemsnit
modstander_sorted <- modstander_summary |> arrange(desc(gennemsnit)) |> pull(modstander)
ggplot(modstander_summary_long |> mutate(modstander = factor(modstander, levels = modstander_sorted)),
aes(x = modstander, y = værdi, fill = type)) +
geom_col(alpha = 0.7, position = "dodge") +
geom_text(aes(label = format(round(værdi), big.mark = ".")), vjust = -0.5, size = 2.5, position = position_dodge(width = 0.9)) +
labs(
x = "Modstander",
y = "Tilskuertal",
title = "Gennemsnitligt og Total tilskuertal per modstander",
fill = "Type"
) +
scale_fill_manual(values = c("gennemsnit" = "lightblue", "total" = "darkblue")) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
# 4. Facettet line plot + Bar chart under (stacked vertically)
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "free_y", ncol = 4) +
labs(x = "År", y = "Tilskuertal", title = "Udvikling per modstander") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"))
# Beregn statistikker per modstander
modstander_summary <- vffkort_renset |>
group_by(modstander) |>
summarise(
gennemsnit = mean(tilskuere, na.rm = TRUE),
total = sum(tilskuere, na.rm = TRUE),
min = min(tilskuere, na.rm = TRUE),
max = max(tilskuere, na.rm = TRUE),
antal_kampe = n(),
.groups = "drop"
) |>
arrange(desc(gennemsnit))
# Bar chart - Gennemsnit og Total tilskuertal per modstander (sammen i samme graf)
modstander_summary_long <- modstander_summary |>
pivot_longer(cols = c(gennemsnit, total), names_to = "type", values_to = "værdi") |>
mutate(type = factor(type, levels = c("gennemsnit", "total")))
# Sortér modstanderne efter gennemsnit
modstander_sorted <- modstander_summary |> arrange(desc(gennemsnit)) |> pull(modstander)
ggplot(modstander_summary_long |> mutate(modstander = factor(modstander, levels = modstander_sorted)),
aes(x = modstander, y = værdi, fill = type)) +
geom_col(alpha = 0.7, position = "dodge") +
geom_text(aes(label = format(round(værdi), big.mark = ".")), vjust = -0.5, size = 2.5, position = position_dodge(width = 0.9)) +
labs(
x = "Modstander",
y = "Tilskuertal",
title = "Gennemsnitligt og Total tilskuertal per modstander",
fill = "Type"
) +
scale_fill_manual(values = c("gennemsnit" = "lightblue", "total" = "darkblue")) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
# Line plot med facetter - Udviklingen for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "free_y", ncol = 4) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"),
legend.position = "none"
)
# Beregn min og max tilskuere for hver modstander + hvilket år det skete
modstander_stats <- vffkort_renset |>
group_by(modstander) |>
summarise(
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
aar_min = aar[which.min(tilskuere)][1],
aar_max = aar[which.max(tilskuere)][1],
.groups = "drop"
)
ggplot(vffkort_renset, aes(x = aar, y = modstander, height = tilskuere, fill = modstander)) +
geom_density_ridges(stat = "identity", alpha = 0.7, scale = 2.5) +
geom_text(data = modstander_stats, aes(x = aar_min, y = modstander, label = paste0("Min: ", min_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkblue") +
geom_text(data = modstander_stats, aes(x = aar_max, y = modstander, label = paste0("Max: ", max_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkred") +
labs(
x = "År",
y = "Modstander",
title = "Tilskuertal gennem årene - Ridge plot"
) +
theme_bw() +
theme(
legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Area plot - Stakket område for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere, fill = modstander)) +
geom_area(alpha = 0.7, colour = "white", linewidth = 0.3) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene",
fill = "Modstander"
) +
scale_fill_brewer(palette = "Set3") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
vffkort_summary <- vffkort_renset |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere), fill = "lightblue", alpha = 0.7, width = 0.6) +
geom_text(aes(y = total_tilskuere, label = format(total_tilskuere, big.mark = ".", decimal.mark = ",")), vjust = -0.5, size = 3) +
geom_text(aes(y = total_tilskuere * 0.5, label = paste0("Min: ", min_tilskuere, " | Max: ", max_tilskuere)),
vjust = 0.5, size = 2.5, colour = "darkblue", fontface = "italic") +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
geom_point(aes(y = middeltal), colour = "darkred", size = 3) +
geom_text(aes(y = middeltal, label = format(round(middeltal), big.mark = "")),
colour = "darkred", vjust = -0.8, size = 3, fontface = "bold") +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = "Tilskuertal gennem årene - Total vs Gennemsnit",
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
# Beregn statistikker per modstander
modstander_summary <- vffkort_renset |>
group_by(modstander) |>
summarise(
gennemsnit = mean(tilskuere, na.rm = TRUE),
total = sum(tilskuere, na.rm = TRUE),
min = min(tilskuere, na.rm = TRUE),
max = max(tilskuere, na.rm = TRUE),
antal_kampe = n(),
.groups = "drop"
) |>
arrange(desc(gennemsnit))
# Bar chart - Gennemsnit og Total tilskuertal per modstander (sammen i samme graf)
modstander_summary_long <- modstander_summary |>
pivot_longer(cols = c(gennemsnit, total), names_to = "type", values_to = "værdi") |>
mutate(type = factor(type, levels = c("gennemsnit", "total")))
# Sortér modstanderne efter gennemsnit
modstander_sorted <- modstander_summary |> arrange(desc(gennemsnit)) |> pull(modstander)
ggplot(modstander_summary_long |> mutate(modstander = factor(modstander, levels = modstander_sorted)),
aes(x = modstander, y = værdi, fill = type)) +
geom_col(alpha = 0.7, position = "dodge") +
geom_text(aes(label = format(round(værdi), big.mark = ".")), vjust = -0.5, size = 2.5, position = position_dodge(width = 0.9)) +
labs(
x = "Modstander",
y = "Tilskuertal",
title = "Gennemsnitligt og Total tilskuertal per modstander",
fill = "Type"
) +
scale_fill_manual(values = c("gennemsnit" = "lightblue", "total" = "darkblue")) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
)
# Line plot med facetter - Udviklingen for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "free_y", ncol = 4) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"),
legend.position = "none"
)
# Line plot med facetter - Udviklingen for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "fixed", ncol = 4) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"),
legend.position = "none"
)
# Beregn min og max tilskuere for hver modstander + hvilket år det skete
modstander_stats <- vffkort_renset |>
group_by(modstander) |>
summarise(
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
aar_min = aar[which.min(tilskuere)][1],
aar_max = aar[which.max(tilskuere)][1],
.groups = "drop"
)
ggplot(vffkort_renset, aes(x = aar, y = modstander, height = tilskuere, fill = modstander)) +
geom_density_ridges(stat = "identity", alpha = 0.7, scale = 2.5) +
geom_text(data = modstander_stats, aes(x = aar_min, y = modstander, label = paste0("Min: ", min_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkblue") +
geom_text(data = modstander_stats, aes(x = aar_max, y = modstander, label = paste0("Max: ", max_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkred") +
labs(
x = "År",
y = "Modstander",
title = "Tilskuertal gennem årene - Ridge plot"
) +
theme_bw() +
theme(
legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Bar + line plot - Total vs Gennemsnit
vffkort_summary <- vffkort_renset |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere), fill = "lightblue", alpha = 0.7, width = 0.6) +
geom_text(aes(y = total_tilskuere, label = format(total_tilskuere, big.mark = ".", decimal.mark = ",")), vjust = -0.5, size = 3) +
geom_text(aes(y = total_tilskuere * 0.5, label = paste0("Min: ", min_tilskuere, " | Max: ", max_tilskuere)),
vjust = 0.5, size = 2.5, colour = "darkblue", fontface = "italic") +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
geom_point(aes(y = middeltal), colour = "darkred", size = 3) +
geom_text(aes(y = middeltal, label = format(round(middeltal), big.mark = "")),
colour = "darkred", vjust = -0.8, size = 3, fontface = "bold") +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = "Tilskuertal gennem årene - Total vs Gennemsnit",
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
pacman::p_load("ggplot2", "readxl", "ggrepel")
options(scipen = 999)
pacman::p_load("tidyverse")
vffkort <- read_rds("vffkort01.rds")
vffkort_renset <- vffkort |>
mutate(
modstander = str_split_fixed(hold, "-", 2)[,2]
) |>
rename(aar = år)
# Line plot med facetter - Udviklingen for hver modstander
ggplot(vffkort_renset, aes(x = aar, y = tilskuere)) +
geom_line(linewidth = 0.8, alpha = 0.7, colour = "darkblue") +
geom_point(size = 2, alpha = 0.6, colour = "darkblue") +
facet_wrap(~modstander, scales = "fixed", ncol = 4) +
labs(
x = "År",
y = "Antal tilskuere",
title = "Tilskuertal gennem årene"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.background = element_rect(fill = "lightblue", colour = "black"),
legend.position = "none"
)
# Ridge plot - Hver modstander som separat "bølge" med min/max værdier på ridges
pacman::p_load("ggridges")
# Beregn min og max tilskuere for hver modstander + hvilket år det skete
modstander_stats <- vffkort_renset |>
group_by(modstander) |>
summarise(
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
aar_min = aar[which.min(tilskuere)][1],
aar_max = aar[which.max(tilskuere)][1],
.groups = "drop"
)
ggplot(vffkort_renset, aes(x = aar, y = modstander, height = tilskuere, fill = modstander)) +
geom_density_ridges(stat = "identity", alpha = 0.7, scale = 2.5) +
geom_text(data = modstander_stats, aes(x = aar_min, y = modstander, label = paste0("Min: ", min_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkblue") +
geom_text(data = modstander_stats, aes(x = aar_max, y = modstander, label = paste0("Max: ", max_tilskuere)),
vjust = -1.2, size = 2.5, inherit.aes = FALSE, fontface = "bold", colour = "darkred") +
labs(
x = "År",
y = "Modstander",
title = "Tilskuertal gennem årene - Ridge plot"
) +
theme_bw() +
theme(
legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Bar + line plot - Total vs Gennemsnit
vffkort_summary <- vffkort_renset |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
ggplot(vffkort_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere), fill = "lightblue", alpha = 0.7, width = 0.6) +
geom_text(aes(y = total_tilskuere, label = format(total_tilskuere, big.mark = ".", decimal.mark = ",")), vjust = -0.5, size = 3) +
geom_text(aes(y = total_tilskuere * 0.5, label = paste0("Min: ", min_tilskuere, " | Max: ", max_tilskuere)),
vjust = 0.5, size = 2.5, colour = "darkblue", fontface = "italic") +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
geom_point(aes(y = middeltal), colour = "darkred", size = 3) +
geom_text(aes(y = middeltal, label = format(round(middeltal), big.mark = "")),
colour = "darkred", vjust = -0.8, size = 3, fontface = "bold") +
scale_x_continuous(
name = "År",
breaks = unique(vffkort_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = "Tilskuertal gennem årene - Total vs Gennemsnit",
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
# Bar + line plot på modstander niveau - Total vs Gennemsnit
# Vælg modstander her:
valgt_modstander <- "BIF"
modstander_summary <- vffkort_renset |>
filter(modstander == valgt_modstander) |>
group_by(aar) |>
summarise(
total_tilskuere = sum(tilskuere, na.rm = TRUE),
antal_kampe = n(),
middeltal = mean(tilskuere, na.rm = TRUE),
min_tilskuere = min(tilskuere, na.rm = TRUE),
max_tilskuere = max(tilskuere, na.rm = TRUE),
.groups = "drop"
)
ggplot(modstander_summary, aes(x = aar)) +
geom_col(aes(y = total_tilskuere), fill = "lightblue", alpha = 0.7, width = 0.6) +
geom_text(aes(y = total_tilskuere, label = format(total_tilskuere, big.mark = ".", decimal.mark = ",")), vjust = -0.5, size = 3) +
geom_text(aes(y = total_tilskuere * 0.5, label = paste0("Min: ", min_tilskuere, " | Max: ", max_tilskuere)),
vjust = 0.5, size = 2.5, colour = "darkblue", fontface = "italic") +
geom_line(aes(y = middeltal), colour = "darkred", linewidth = 1.2, group = 1) +
geom_point(aes(y = middeltal), colour = "darkred", size = 3) +
geom_text(aes(y = middeltal, label = format(round(middeltal), big.mark = "")),
colour = "darkred", vjust = -0.8, size = 3, fontface = "bold") +
scale_x_continuous(
name = "År",
breaks = unique(modstander_summary$aar)
) +
scale_y_continuous(
name = "Total tilskuere",
sec.axis = sec_axis(~.*100, name = "Gennemsnitligt tilskuertal")
) +
labs(
title = paste0("Tilskuertal gennem årene mod ", valgt_modstander, " - Total vs Gennemsnit"),
subtitle = "Blå søjler = total tilskuere (fra venstre akse), Rød linje = gennemsnitligt tilskuertal (fra højre akse),\nKursiv tekst = laveste og højeste tilskuertal for en enkelt kamp per år"
) +
theme_bw() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_blank(),
axis.title.y = element_text(colour = "lightblue"),
axis.title.y.right = element_text(colour = "darkred")
)
